# Форма оплаты {#checkout_ru}

###### Последнее обновление: 2017-11-14 | [Редактировать на GitHub](https://github.com/QIWI-API/pull-payments-docs/blob/master/_checkout_ru.html.md)

Провайдер может предложить пользователю немедленно оплатить счет с помощью переадресации на платежную форму.

~~~text
Вызов формы оплаты
~~~
~~~http
GET /order/external/main.action?shop=2042&transaction=1234567&successUrl=http%3A%2F%2Fmystore.com%2Fsuccess%3Fa%3D1%26b%3D2&failUrl=http%3A%2F%2Fmystore.com%2Ffail%3Fa%3D1%26b%3D2&pay_source=qw HTTP/1.1
Host: bill.qiwi.com
~~~

<h3 class="request method">Запрос → REDIRECT</h3>

<ul class="nestedList url">
    <li><h3>URL <span>https://bill.qiwi.com/order/external/main.action</span></h3>
    </li>
</ul>

<aside class="notice">
В ответ на запрос сервер формирует на сайте QIWI Wallet страницу с выставленным счетом и выбором способа оплаты счета.

Если провайдер использует выставление счета через <a href="#webform_ru">веб-форму</a>, данное действие выполняется автоматически.
</aside>

<ul class="nestedList params">
    <li><h3>Параметры</h3>
    </li>
</ul>

Параметр|Тип|Описание|Обяз.
---------|--------|-------|-----
shop| Строка|Идентификатор провайдера. Соответствует параметру **prv_id** из [запроса на выставление счета](#invoice_rest).|+
transaction|Строка|Идентификатор счета в информационной системе провайдера. Соответствует параметру **bill_id** из [запроса на выставление счета](#invoice_rest).|+
iframe|Логический, true/false| Признак отображения страницы в iframe (более компактный вид, удобный для встраивания ее в сайт провайдера). По умолчанию `false`|-
successUrl|URL-закодированная строка|URL для переадресации в случае успешного создания транзакции в QIWI Wallet. Ссылка должна вести на сайт провайдера. **Если пользователь выбрал на платежной форме способ оплаты, отличный от оплаты с баланса QIWI Кошелька, то переадресация на сайт провайдера не выполняется.**|-
failUrl|URL-закодированная строка|URL для переадресации в случае неуспеха при создании транзакции в QIWI Wallet. Ссылка должна вести на сайт провайдера. **Если пользователь выбрал на платежной форме способ оплаты, отличный от оплаты с баланса QIWI Кошелька, то переадресация на сайт провайдера не выполняется.**|-
target|Строка "iframe"|Флаг, показывающий, что ссылки в параметрах <br>`successUrl` / `failUrl` открываются в iframe. Если отсутствует, то считается выключенным|-
pay_source|Строка| Способ оплаты по умолчанию, который необходимо отобразить пользователю при открытии платежной формы. Возможные значения:<br>`qw` – оплата с баланса QIWI Кошелька;<br> `mobile` – оплата с баланса мобильного телефона;<br> `card` – оплата банковской картой;<br> `wm` – оплата с привязанного кошелька WebMoney;<br> `ssk` – оплата наличными в терминале QIWI.<br>Если способ оплаты не доступен, пользователю отображается предупреждение, при этом на странице можно выбрать другие способы оплаты.|-

## Возврат на сайт провайдера {#back_url}

~~~text
Возврат клиента после успешного создания транзакции
~~~
~~~http
GET /success?a=1&b=2&order=1234567 HTTP/1.1
Host: mystore.com
~~~
~~~text
Возврат клиента в случае неуспеха при создании транзакции
~~~
~~~http
GET /fail?a=1&b=2&order=1234567 HTTP/1.1
Host: mystore.com
~~~

<aside class="notice">
Если в ссылке на платежную форму указан параметр <i>successUrl</i> или <i>failUrl</i>, то сайт QIWI Wallet переадресует пользователя на соответствующий URL после завершения процесса оплаты.  <b>Переадресация выполняется только при оплате с баланса QIWI Кошелька</b>.
</aside>

<aside class="warning">
Если перенаправление на адрес, указанный в параметре <i>successUrl</i> / <i>failUrl</i>, по какой-либо причине не произошло, для принятия окончательного решения о предоставлении клиенту услуги или товара провайдеру необходимо дождаться <a href="#notification_ru">уведомления</a> от сервера QIWI Wallet с финальным статусом счета. Если провайдер не использует уведомления, необходимо запрашивать статус счета <a href="#invoice-status">отдельным запросом API</a>.
</aside>

При переадресации в ссылку добавляется параметр <i>order</i>, в котором будет передан исходный идентификатор счета у провайдера. Используя этот параметр, провайдер может отобразить необходимую информацию на своей стороне.
